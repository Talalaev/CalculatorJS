var Calculator,isNumeric;Calculator=function(){function a(a){this.options=a,this.expression=this.options.expression||"",this.lastCharType=this.options.lastCharType||""}return a.prototype.toGlue=function(a,b){var c,d,e;if(b=this.expression,""===b&&(isNumeric(a)||"("===a))return this.expression+=a;if(d=b.slice(b.length-1),isNumeric(d)){if(isNumeric(a))return this.expression+=a;if(")"===a)return(e=b.match(/\(/g))?(c=b.match(/\)/g),c&&e.length>=c.length+1?this.expression+=a:this.expression+=a):this.expression;if("+"===a||"-"===a||"*"===a||"/"===a)return this.expression+=a;if("."===a&&!b.match(/\.[0-9]+$/))return this.expression+=a}if("("===d&&(isNumeric(a)||"("===a))return this.expression+=a;if(")"===d){if("+"===a||"-"===a||"*"===a||"/"===a)return this.expression+=a;if(")"===a)return(e=b.match(/\(/g))?(c=b.match(/\)/g),c?e.length>=c.length+1?this.expression+=a:this.expression:this.expression+=a):this.expression}return"+"!==d&&"-"!==d&&"*"!==d&&"/"!==d||!isNumeric(a)&&"("!==a?"."===d&&isNumeric(a)?this.expression+=a:this.expression:this.expression+=a},a.prototype.display=function(a,b){return a.innerHTML=b},a.prototype.add=function(a){var b,c;return b=function(a,b,c,d,e){return(1e9*+b+1e9*+d)/1e9},c=a.replace(/(\-?\d+\.?(\d+)?) ?\+ ?(\-?\d+\.?(\d+)?)/,b),c!==a&&(c=this.add(c)),c},a.prototype.subtract=function(a){var b,c;return b=function(a,b,c,d,e){return(1e9*b-1e9*d)/1e9},c=a.replace(/(\-?\d+\.?(\d+)?) ?\- ?(\-?\d+\.?(\d+)?)/,b),c!==a&&(c=this.subtract(c)),c},a.prototype.multiply=function(a){var b,c;return b=function(a,b,c,d,e){return 1e9*b*(1e9*d)/1e18},c=a.replace(/(\-?\d+\.?(\d+)?) ?\* ?(\-?\d+\.?(\d+)?)/,b),c!==a&&(c=this.multiply(c)),c},a.prototype.divide=function(a){var b,c;return b=function(a,b,c,d,e){return b/d},c=a.replace(/(\-?\d+\.?(\d+)?) ?\/ ?(\-?\d+\.?(\d+)?)/,b),c!==a&&(c=this.divide(c)),c},a.prototype.calculate=function(a){var b,c;return c=this,b=a.replace(/\(([^(^)]+)\)/g,function(a,b){return c.add(c.subtract(c.multiply(c.divide(b))))}),b!==a&&(b=this.calculate(b)),this.add(this.subtract(this.multiply(this.divide(b))))},a.prototype.deleteLastChar=function(a){var b,c;return c=null,b=a.slice(a.length-2,a.length-1),"."===b||" "===b?(c=a.slice(0,a.length-2),~c[c.length-1].search(/\d/)&&(this.lastCharType="number"),~c[c.length-1].search(/\(/)&&(this.lastCharType="bracketOpen"),~c[c.length-1].search(/\)/)&&(this.lastCharType="bracketClose"),~c[c.length-1].search(/[\+\-\*\/]/)&&(this.lastCharType="operator"),c):"-"===b?(c=a.slice(0,a.length-3),~c[c.length-1].search(/\d/)&&(this.lastCharType="number"),~c[c.length-1].search(/\(/)&&(this.lastCharType="bracketOpen"),~c[c.length-1].search(/\)/)&&(this.lastCharType="bracketClose"),~c[c.length-1].search(/[\+\-\*\/]/)&&(this.lastCharType="operator"),c):a.length<=1?this.lastCharType="":(c=a.slice(0,a.length-1),~c[c.length-1].search(/\d/)&&(this.lastCharType="number"),~c[c.length-1].search(/\(/)&&(this.lastCharType="bracketOpen"),~c[c.length-1].search(/\)/)&&(this.lastCharType="bracketClose"),~c[c.length-1].search(/[\+\-\*\/]/)&&(this.lastCharType="operator"),c)},a.prototype.deleteChars=function(a){return this.lastCharType=""},a.prototype.changeSign=function(a){var b,c,d;if(d=null,a=a.replace(/(\d+\.?(\d+)?)$/,function(a){return d=a,""}),d){if(b=a.slice(-1),""===b)return"-"+d;("("===b||"*"===b||"/"===b)&&(a+="-"+d),"-"===b&&(a="-"===a[0]&&1===a.length?d:a.slice(0,-1)+"+"+d),"+"===b&&(a=a.slice(0,-1)+"-"+d)}return d=null,a=a.replace(/(\d+\.?(\d+)?)$/,function(a){return d=a,""}),d&&(c=a.slice(-2),"(+"===c||"*+"===c||"/+"===c?a=a.slice(0,-2)+c.slice(0,1)+d:a+=d),a},a}(),isNumeric=function(a){return!isNaN(parseFloat(a))&&isFinite(a)};