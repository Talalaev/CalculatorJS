var Calculator;Calculator=function(){function a(a){this.options=a,this.expression=this.options.expression||"",this.lastCharType=this.options.lastCharType||""}return a.prototype.toGlue=function(a,b){var c,d;return d=this.expression.match(/\(/g)?this.expression.match(/\(/g).length:0,c=this.expression.match(/\)/g)?this.expression.match(/\)/g).length:0,"bracketClose"===b&&d===c?this.expression:this.expression.length>=26?this.expression:"comma"===b&&this.expression.match(/\d+?\.\d+?$/)?this.expression:("comma"!==b||"number"===this.lastCharType&&"comma"!==this.lastCharType)&&("bracketOpen"!==b||"bracketClose"!==this.lastCharType&&"comma"!==this.lastCharType&&"number"!==this.lastCharType)&&("bracketClose"!==b&&"operator"!==b&&"comma"!==b||this.lastCharType&&"bracketOpen"!==this.lastCharType&&"operator"!==this.lastCharType&&"comma"!==this.lastCharType)?"operator"===this.lastCharType&&"number"===b?(this.lastCharType=b,this.expression+=" "+a[0]):this.lastCharType&&b!==this.lastCharType&&"comma"!==b&&"bracketClose"!==b&&"number"!==b?(this.lastCharType=b,this.expression+=" "+a[0]):(this.lastCharType=b,this.expression+=a[0]):this.expression},a.prototype.display=function(a,b){return a.innerHTML=b},a.prototype.add=function(a){var b,c;return b=function(a,b,c,d,e){return(1e9*+b+1e9*+d)/1e9},c=a.replace(/(\-?\d+\.?(\d+)?) ?\+ ?(\-?\d+\.?(\d+)?)/,b),c!==a&&(c=this.add(c)),c},a.prototype.subtract=function(a){var b,c;return b=function(a,b,c,d,e){return(1e9*b-1e9*d)/1e9},c=a.replace(/(\-?\d+\.?(\d+)?) ?\- ?(\-?\d+\.?(\d+)?)/,b),c!==a&&(c=this.subtract(c)),c},a.prototype.multiply=function(a){var b,c;return b=function(a,b,c,d,e){return 1e9*b*(1e9*d)/1e18},c=a.replace(/(\-?\d+\.?(\d+)?) ?\* ?(\-?\d+\.?(\d+)?)/,b),c!==a&&(c=this.multiply(c)),c},a.prototype.divide=function(a){var b,c;return b=function(a,b,c,d,e){return b/d},c=a.replace(/(\-?\d+\.?(\d+)?) ?\/ ?(\-?\d+\.?(\d+)?)/,b),c!==a&&(c=this.divide(c)),c},a.prototype.calculate=function(a){var b,c;return c=this,b=a.replace(/\(([^(^)]+)\)/g,function(a,b){return c.add(c.subtract(c.multiply(c.divide(b))))}),b!==a&&(b=this.calculate(b)),this.add(this.subtract(this.multiply(this.divide(b))))},a.prototype.deleteLastChar=function(a){var b,c;return c=null,b=a.slice(a.length-2,a.length-1),"."===b||" "===b?(c=a.slice(0,a.length-2),~c[c.length-1].search(/\d/)&&(this.lastCharType="number"),~c[c.length-1].search(/\(/)&&(this.lastCharType="bracketOpen"),~c[c.length-1].search(/\)/)&&(this.lastCharType="bracketClose"),~c[c.length-1].search(/[\+\-\*\/]/)&&(this.lastCharType="operator"),c):"-"===b?(c=a.slice(0,a.length-3),~c[c.length-1].search(/\d/)&&(this.lastCharType="number"),~c[c.length-1].search(/\(/)&&(this.lastCharType="bracketOpen"),~c[c.length-1].search(/\)/)&&(this.lastCharType="bracketClose"),~c[c.length-1].search(/[\+\-\*\/]/)&&(this.lastCharType="operator"),c):a.length<=1?this.lastCharType="":(c=a.slice(0,a.length-1),~c[c.length-1].search(/\d/)&&(this.lastCharType="number"),~c[c.length-1].search(/\(/)&&(this.lastCharType="bracketOpen"),~c[c.length-1].search(/\)/)&&(this.lastCharType="bracketClose"),~c[c.length-1].search(/[\+\-\*\/]/)&&(this.lastCharType="operator"),c)},a.prototype.deleteChars=function(a){return this.lastCharType=""},a.prototype.changeSign=function(a){var b;return b=a.replace(/((\-?\d+\.?(\d+)?\)?) ([\+\-\*\/]) ((\-?)(\d+\.?(\d+)?)))$/,function(a,b,c,d,e,f,g,h,i){return"-"===e?c+" + "+h:"+"===e?c+" - "+h:"*"!==e&&"/"!==e||!g?c+" "+e+" -"+h:c+" "+e+" "+h}),b!==a?b:a.replace(/^(\(?)((\-?)(\d+\.?(\d+)?))$/,function(a,b,c,d,e){return d?""+b+e:b+"-"+e})},a}();